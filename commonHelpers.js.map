{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/js/index.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<div class=\"gallery-card\">\n    \n            <a class=\"gallery-card__link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-card__img\" src=\"${webformatURL}\" alt=\"${tags}\"  loading=\"lazy\" />\n            </a>\n        \n    <div class=\"gallery-card__info\">\n      <p class=\"gallery-card__info--item\">\n        <b>Likes: ${likes}</b>\n      </p>\n      <p class=\"gallery-card__info--item\">\n        <b>Views: ${views}</b>\n      </p>\n      <p class=\"gallery-card__info--item\">\n        <b>Comments: ${comments}</b>\n      </p>\n      <p class=\"gallery-card__info--item\">\n        <b>Downloads: ${downloads}</b>\n      </p>\n    </div>\n  </div>`\n    )\n    .join('');\n}\n\nexport let lightbox = new SimpleLightbox('.gallery-card__link', {\n  captionDelay: 250,\n});\n","import axios from 'axios';\n\nexport class PixabayAPI {\n  #API_KEY = '42494915-f1925227b1d4f602df08c38a4';\n  #BASE_URL = 'https://pixabay.com/api/';\n\n  baseSearchParams = {\n    key: this.#API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n  };\n\n  constructor() {\n    this.query = '';\n    this.page = 1;\n  }\n\n  async fetchHits() {\n    const searchParams = new URLSearchParams({\n      ...this.baseSearchParams,\n      q: this.query,\n      page: this.page,\n    });\n\n    const response = await axios.get(`${this.#BASE_URL}?${searchParams}`);\n    return response;\n  }\n\n  restPage() {\n    this.page = 1;\n  }\n}\n","import Notiflix from 'notiflix';\nimport { createMarkup, lightbox } from './render-functions.js';\nimport { PixabayAPI } from './pixabay-api.js';\n\nconst refs = {\n  searchForm: document.querySelector('#search-form'),\n  divGalleryContainer: document.querySelector('.gallery'),\n};\n\nconst target = document.querySelector('.js-guard');\n\nconst PER_PAGE = 40;\n\nconst pixabayApiInstance = new PixabayAPI();\n\nlet options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\n\nlet observer = new IntersectionObserver(scrollLoadMore, options);\n\nfunction scrollLoadMore(entries, observer) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      pixabayApiInstance.page += 1;\n\n      const response = await pixabayApiInstance.fetchHits();\n      const arrayImages = response.data.hits;\n\n      refs.divGalleryContainer.insertAdjacentHTML(\n        'beforeend',\n        createMarkup(arrayImages)\n      );\n      lightbox.refresh();\n\n      if (arrayImages.length <= PER_PAGE * pixabayApiInstance.page) {\n        Notiflix.Notify.failure(\n          'We`re sorry, but you`ve reached the end of search results.'\n        );\n        observer.unobserve(target);\n      }\n    }\n  });\n}\n\nasync function handleSearchFormSubmit(event) {\n  event.preventDefault();\n\n  refs.divGalleryContainer.innerHTML = '';\n\n  const searchQuery = event.target.firstElementChild.value.trim();\n  pixabayApiInstance.query = searchQuery;\n  pixabayApiInstance.restPage();\n\n  if (pixabayApiInstance.query === '') {\n    return Notiflix.Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n\n  try {\n    const response = await pixabayApiInstance.fetchHits();\n    const arrayImages = response.data.hits;\n    const totalImages = response.data.totalHits;\n\n    if (totalImages !== 0) {\n      Notiflix.Notify.success(`Hooray! We found ${totalImages} images.`);\n    }\n\n    refs.divGalleryContainer.innerHTML = createMarkup(arrayImages);\n    lightbox.refresh();\n    observer.observe(target);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nrefs.searchForm.addEventListener('submit', handleSearchFormSubmit);\n"],"names":["createMarkup","arr","largeImageURL","webformatURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","PixabayAPI","__privateAdd","_API_KEY","_BASE_URL","__publicField","__privateGet","searchParams","axios","refs","target","PER_PAGE","pixabayApiInstance","options","observer","scrollLoadMore","entries","entry","arrayImages","Notiflix","handleSearchFormSubmit","event","searchQuery","response","totalImages","error"],"mappings":"irCAGO,SAASA,EAAaC,EAAK,CAChC,OAAOA,EACJ,IACC,CAAC,CACC,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,kDAEsCN,CAAa;AAAA,sDACTC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,oBAK5DC,CAAK;AAAA;AAAA;AAAA,oBAGLC,CAAK;AAAA;AAAA;AAAA,uBAGFC,CAAQ;AAAA;AAAA;AAAA,wBAGPC,CAAS;AAAA;AAAA;AAAA,SAI5B,EACA,KAAK,EAAE,CACZ,CAEO,IAAIC,EAAW,IAAIC,EAAe,sBAAuB,CAC9D,aAAc,GAChB,CAAC,UCvCM,MAAMC,CAAW,CAYtB,aAAc,CAXdC,EAAA,KAAAC,EAAW,sCACXD,EAAA,KAAAE,EAAY,4BAEZC,EAAA,wBAAmB,CACjB,IAAKC,EAAA,KAAKH,GACV,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACd,GAGI,KAAK,MAAQ,GACb,KAAK,KAAO,CACb,CAED,MAAM,WAAY,CAChB,MAAMI,EAAe,IAAI,gBAAgB,CACvC,GAAG,KAAK,iBACR,EAAG,KAAK,MACR,KAAM,KAAK,IACjB,CAAK,EAGD,OADiB,MAAMC,EAAM,IAAI,GAAGF,EAAA,KAAKF,EAAS,IAAIG,CAAY,EAAE,CAErE,CAED,UAAW,CACT,KAAK,KAAO,CACb,CACH,CA9BEJ,EAAA,YACAC,EAAA,YCAF,MAAMK,EAAO,CACX,WAAY,SAAS,cAAc,cAAc,EACjD,oBAAqB,SAAS,cAAc,UAAU,CACxD,EAEMC,EAAS,SAAS,cAAc,WAAW,EAE3CC,EAAW,GAEXC,EAAqB,IAAIX,EAE/B,IAAIY,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEIC,EAAW,IAAI,qBAAqBC,EAAgBF,CAAO,EAE/D,SAASE,EAAeC,EAASF,EAAU,CACzCE,EAAQ,QAAQ,MAAMC,GAAS,CAC7B,GAAIA,EAAM,eAAgB,CACxBL,EAAmB,MAAQ,EAG3B,MAAMM,GADW,MAAMN,EAAmB,aACb,KAAK,KAElCH,EAAK,oBAAoB,mBACvB,YACAnB,EAAa4B,CAAW,CAChC,EACMnB,EAAS,QAAO,EAEZmB,EAAY,QAAUP,EAAWC,EAAmB,OACtDO,EAAS,OAAO,QACd,4DACV,EACQL,EAAS,UAAUJ,CAAM,EAE5B,CACL,CAAG,CACH,CAEA,eAAeU,EAAuBC,EAAO,CAC3CA,EAAM,eAAc,EAEpBZ,EAAK,oBAAoB,UAAY,GAErC,MAAMa,EAAcD,EAAM,OAAO,kBAAkB,MAAM,OAIzD,GAHAT,EAAmB,MAAQU,EAC3BV,EAAmB,SAAQ,EAEvBA,EAAmB,QAAU,GAC/B,OAAOO,EAAS,OAAO,QACrB,0EACN,EAGE,GAAI,CACF,MAAMI,EAAW,MAAMX,EAAmB,YACpCM,EAAcK,EAAS,KAAK,KAC5BC,EAAcD,EAAS,KAAK,UAE9BC,IAAgB,GAClBL,EAAS,OAAO,QAAQ,oBAAoBK,CAAW,UAAU,EAGnEf,EAAK,oBAAoB,UAAYnB,EAAa4B,CAAW,EAC7DnB,EAAS,QAAO,EAChBe,EAAS,QAAQJ,CAAM,CACxB,OAAQe,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH,CAEAhB,EAAK,WAAW,iBAAiB,SAAUW,CAAsB"}